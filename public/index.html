<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BAGWORK - 1v1 Video Game Casino</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Bangers&family=Russo+One&family=Space+Grotesk:wght@400;500;600;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --white: #FFFFFF;
      --white-90: rgba(255,255,255,0.9);
      --white-70: rgba(255,255,255,0.7);
      --white-50: rgba(255,255,255,0.5);
      --white-30: rgba(255,255,255,0.3);
      --white-20: rgba(255,255,255,0.2);
      --white-10: rgba(255,255,255,0.1);
      --white-05: rgba(255,255,255,0.05);
      --accent: #BFFF00;
      --accent-50: rgba(191,255,0,0.5);
      --accent-30: rgba(191,255,0,0.3);
      --accent-20: rgba(191,255,0,0.2);
      --black: #000000;
      --void: #030303;
      --dark: #080808;
      --gray: #0E0E0E;
      --gray-mid: #1A1A1A;
      --gray-light: #2A2A2A;
      --text: #FFFFFF;
      --text-dim: #666666;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: 'Space Grotesk', sans-serif;
      background: var(--void);
      color: var(--text);
      overflow-x: hidden;
      min-height: 100vh;
    }

    /* Noise texture overlay */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='5' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.04'/%3E%3C/svg%3E");
      pointer-events: none;
      z-index: 10000;
    }

    /* Scanlines */
    body::after {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: repeating-linear-gradient(
        0deg,
        transparent,
        transparent 1px,
        rgba(0, 0, 0, 0.1) 1px,
        rgba(0, 0, 0, 0.1) 2px
      );
      pointer-events: none;
      z-index: 10001;
      animation: scanlineFlicker 0.1s infinite;
    }

    @keyframes scanlineFlicker {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.97; }
    }

    ::selection {
      background: var(--white);
      color: var(--black);
    }

    /* Glitch keyframes */
    @keyframes glitch {
      0%, 100% {
        text-shadow: -2px 0 var(--white-50), 2px 0 var(--white-30);
        transform: translate(0);
      }
      20% {
        text-shadow: 2px 0 var(--white-50), -2px 0 var(--white-30);
        transform: translate(-1px, 1px);
      }
      40% {
        text-shadow: -2px 0 var(--white-30), 2px 0 var(--white-50);
        transform: translate(1px, -1px);
      }
      60% {
        text-shadow: 2px 0 var(--white-50), -2px 0 var(--white-30);
        transform: translate(0);
      }
      80% {
        text-shadow: -1px 0 var(--white-50), 1px 0 var(--white-30);
        transform: translate(-1px, 0);
      }
    }

    @keyframes flicker {
      0%, 19.999%, 22%, 62.999%, 64%, 64.999%, 70%, 100% { opacity: 1; }
      20%, 21.999%, 63%, 63.999%, 65%, 69.999% { opacity: 0.6; }
    }

    @keyframes blink {
      0%, 100% { opacity: 1; box-shadow: 0 0 15px var(--accent); }
      50% { opacity: 0.3; box-shadow: 0 0 5px var(--accent); }
    }

    @keyframes gridPulse {
      0%, 100% { opacity: 0.4; }
      50% { opacity: 0.8; }
    }

    @keyframes badgeGlow {
      0%, 100% { box-shadow: 0 0 20px var(--accent-20); }
      50% { box-shadow: 0 0 30px var(--accent-30), 0 0 50px var(--accent-20); }
    }

    @keyframes badgeShine {
      0% { left: -100%; }
      50%, 100% { left: 200%; }
    }

    @keyframes ticker {
      0% { transform: translateX(0); }
      100% { transform: translateX(-50%); }
    }

    /* ===== NAVIGATION ===== */
    nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      padding: 1.5rem 3rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      z-index: 1000;
      background: linear-gradient(to bottom, var(--void) 0%, var(--void) 50%, transparent 100%);
    }

    .logo {
      font-family: 'Russo One', sans-serif;
      font-size: 1.8rem;
      color: var(--white);
      letter-spacing: 3px;
      text-decoration: none;
      text-shadow: 0 0 10px var(--white-50), 0 0 30px var(--white-30);
      display: flex;
      align-items: center;
      gap: 0.5rem;
      animation: flicker 4s infinite;
    }

    .logo:hover {
      animation: glitch 0.3s ease;
    }

    .logo-x {
      font-family: 'Bangers', cursive;
      font-size: 1.2rem;
      background: var(--white);
      color: var(--black);
      padding: 0.15rem 0.5rem;
      transform: rotate(-8deg) skewX(-5deg);
      box-shadow: 0 0 15px var(--white-50), 0 0 30px var(--white-30);
    }

    .nav-links {
      display: flex;
      gap: 2.5rem;
      list-style: none;
    }

    .nav-links a {
      color: var(--text-dim);
      text-decoration: none;
      font-size: 0.7rem;
      font-weight: 700;
      letter-spacing: 3px;
      text-transform: uppercase;
      transition: all 0.2s;
      position: relative;
      padding: 0.5rem 0;
    }

    .nav-links a::before {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 0;
      height: 2px;
      background: var(--white);
      box-shadow: 0 0 10px var(--white);
      transition: width 0.3s ease;
    }

    .nav-links a:hover {
      color: var(--white);
      text-shadow: 0 0 10px var(--white-50);
    }

    .nav-links a:hover::before {
      width: 100%;
    }

    .nav-cta {
      font-family: 'Russo One', sans-serif;
      background: var(--white);
      color: var(--black);
      padding: 0.9rem 1.8rem;
      text-decoration: none;
      font-size: 0.85rem;
      letter-spacing: 2px;
      clip-path: polygon(10px 0, 100% 0, calc(100% - 10px) 100%, 0 100%);
      transition: all 0.2s;
      box-shadow: 0 0 20px var(--white-30);
    }

    .nav-cta:hover {
      box-shadow: 0 0 40px var(--white-50);
      transform: scale(1.05);
    }

    /* ===== HERO ===== */
    .hero {
      min-height: 100vh;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 8rem 4rem 4rem 4rem;
      overflow: hidden;
    }

    .hero-bg {
      position: absolute;
      inset: 0;
      background:
        radial-gradient(ellipse at 20% 30%, var(--white-10) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 70%, var(--white-05) 0%, transparent 45%),
        radial-gradient(ellipse at 90% 20%, var(--white-05) 0%, transparent 35%);
    }

    .hero-grid {
      position: absolute;
      inset: 0;
      background-image:
        linear-gradient(var(--white-05) 1px, transparent 1px),
        linear-gradient(90deg, var(--white-05) 1px, transparent 1px);
      background-size: 50px 50px;
      mask-image: radial-gradient(ellipse at center, black 40%, transparent 75%);
      animation: gridPulse 4s ease infinite;
    }

    /* Diagonal lines */
    .hero::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -10%;
      width: 800px;
      height: 200%;
      background: repeating-linear-gradient(
        -45deg,
        transparent,
        transparent 40px,
        var(--white-02) 40px,
        var(--white-02) 80px
      );
      pointer-events: none;
    }

    .hero-content {
      position: relative;
      z-index: 10;
      text-align: center;
      max-width: 1000px;
    }

    /* Badge */
    .hero-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.75rem;
      background: var(--white-05);
      border: 2px solid var(--white-30);
      padding: 0.6rem 1.5rem;
      margin-bottom: 2rem;
      clip-path: polygon(12px 0, 100% 0, calc(100% - 12px) 100%, 0 100%);
      box-shadow: 0 0 20px var(--white-10);
    }

    .hero-badge-icon {
      width: 10px;
      height: 10px;
      background: var(--accent);
      box-shadow: 0 0 10px var(--accent);
      animation: blink 0.8s ease infinite;
    }

    .hero-badge-text {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.7rem;
      letter-spacing: 3px;
      color: var(--white-70);
      text-transform: uppercase;
    }

    /* Title */
    .hero-title {
      font-family: 'Bangers', cursive;
      font-size: clamp(5rem, 18vw, 14rem);
      line-height: 0.9;
      letter-spacing: 8px;
      margin-bottom: 1rem;
      color: var(--white);
      text-shadow:
        0 0 10px var(--white-50),
        0 0 30px var(--white-30),
        0 0 60px var(--white-20),
        6px 6px 0 var(--white-10);
      animation: glitch 8s ease infinite;
      animation-play-state: paused;
    }

    .hero-title:hover {
      animation-play-state: running;
    }

    .title-tld {
      color: var(--accent);
      text-shadow:
        0 0 10px var(--accent-50),
        0 0 30px var(--accent-30),
        0 0 60px var(--accent-20);
    }

    .hero-subtitle {
      font-family: 'Russo One', sans-serif;
      font-size: clamp(1.2rem, 3vw, 2rem);
      letter-spacing: 8px;
      color: var(--white-70);
      margin-bottom: 2.5rem;
      text-transform: uppercase;
    }

    .hero-desc {
      font-size: 1rem;
      color: var(--text-dim);
      max-width: 550px;
      margin: 0 auto 2rem;
      line-height: 1.8;
    }

    .hero-desc strong {
      color: var(--white);
      text-shadow: 0 0 10px var(--white-30);
    }

    /* VS Battle */
    .battle-section {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 2.5rem;
      margin-bottom: 2.5rem;
    }

    .player-slot {
      width: 100px;
      height: 130px;
      background: var(--gray);
      border: 2px solid var(--gray-mid);
      clip-path: polygon(10px 0, 100% 0, calc(100% - 10px) 100%, 0 100%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 0.75rem;
      transition: all 0.3s ease;
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }

    .player-slot::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 3px;
      background: var(--white);
      transform: scaleX(0);
      transition: transform 0.3s ease;
    }

    .player-slot:hover {
      border-color: var(--white-50);
      box-shadow: 0 0 30px var(--white-10);
      transform: translateY(-5px);
    }

    .player-slot:hover::before {
      transform: scaleX(1);
    }

    .player-avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--accent);
      box-shadow: 0 0 20px var(--accent-30);
    }

    .player-slot.p2 .player-avatar {
      background: var(--gray-light);
      box-shadow: 0 0 20px var(--white-10);
    }

    .player-avatar svg {
      width: 20px;
      height: 20px;
      stroke: var(--black);
      stroke-width: 2.5;
      fill: none;
    }

    .player-slot.p2 .player-avatar svg {
      stroke: var(--white);
    }

    .player-name {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.55rem;
      text-transform: uppercase;
      letter-spacing: 2px;
      color: var(--text-dim);
    }

    .vs-center {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.5rem;
    }

    .vs-text {
      font-family: 'Bangers', cursive;
      font-size: 3rem;
      color: var(--white);
      text-shadow: 0 0 20px var(--white-50), 3px 3px 0 var(--white-20);
    }

    .vs-sub {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.5rem;
      text-transform: uppercase;
      letter-spacing: 3px;
      color: var(--text-dim);
    }

    /* Feature badges */
    .feature-badges {
      display: flex;
      gap: 1rem;
      justify-content: center;
      margin-bottom: 2.5rem;
      flex-wrap: wrap;
    }

    .feature-badge {
      font-family: 'Russo One', sans-serif;
      font-size: 0.8rem;
      letter-spacing: 2px;
      padding: 0.5rem 1rem;
      background: var(--accent);
      color: var(--black);
      clip-path: polygon(8px 0, 100% 0, calc(100% - 8px) 100%, 0 100%);
      box-shadow: 0 0 20px var(--accent-30);
      animation: badgeGlow 2s ease infinite;
      position: relative;
      overflow: hidden;
    }

    .feature-badge::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 50%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(0,0,0,0.2), transparent);
      animation: badgeShine 3s ease infinite;
    }

    .feature-badge.outline {
      background: transparent;
      border: 2px solid var(--white-50);
      color: var(--white);
      box-shadow: 0 0 20px var(--white-10);
    }

    .feature-badge.outline::before {
      background: linear-gradient(90deg, transparent, var(--white-20), transparent);
    }

    /* CTA */
    .cta-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1.5rem;
    }

    .email-form {
      display: flex;
    }

    .email-input {
      width: 280px;
      padding: 1rem 1.25rem;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      background: var(--gray);
      border: 2px solid var(--gray-mid);
      border-right: none;
      color: var(--text);
      outline: none;
      transition: all 0.3s;
      clip-path: polygon(10px 0, 100% 0, 100% 100%, 0 100%);
    }

    .email-input::placeholder {
      color: var(--text-dim);
    }

    .email-input:focus {
      border-color: var(--white-50);
      box-shadow: 0 0 20px var(--white-10);
    }

    .submit-btn {
      padding: 1rem 2rem;
      font-family: 'Russo One', sans-serif;
      font-size: 0.85rem;
      letter-spacing: 2px;
      background: var(--accent);
      border: none;
      color: var(--black);
      cursor: pointer;
      transition: all 0.3s;
      clip-path: polygon(0 0, 100% 0, calc(100% - 10px) 100%, 0 100%);
      box-shadow: 0 0 20px var(--accent-30);
    }

    .submit-btn:hover {
      box-shadow: 0 0 40px var(--accent-50);
      transform: scale(1.02);
    }

    .waitlist-count {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.65rem;
      color: var(--text-dim);
      letter-spacing: 1px;
    }

    .waitlist-count span {
      color: var(--accent);
      text-shadow: 0 0 10px var(--accent-30);
    }

    /* ===== TICKER ===== */
    .ticker {
      background: var(--white);
      padding: 1rem 0;
      overflow: hidden;
      position: relative;
      border-top: 3px solid var(--gray-light);
      border-bottom: 3px solid var(--gray-light);
      box-shadow: 0 0 40px var(--white-20);
    }

    .ticker-track {
      display: flex;
      animation: ticker 25s linear infinite;
    }

    .ticker-item {
      font-family: 'Bangers', cursive;
      font-size: 1.5rem;
      letter-spacing: 4px;
      color: var(--black);
      padding: 0 2rem;
      white-space: nowrap;
      display: flex;
      align-items: center;
      gap: 2rem;
    }

    .ticker-item::after {
      content: 'x';
      font-family: 'Russo One', sans-serif;
      font-size: 1rem;
      background: var(--black);
      color: var(--white);
      padding: 0.2rem 0.5rem;
      transform: rotate(-5deg);
    }

    /* ===== STATS ===== */
    .stats-bar {
      background: var(--dark);
      border-top: 1px solid var(--gray-mid);
      padding: 3rem 4rem;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 2rem;
      max-width: 1000px;
      margin: 0 auto;
    }

    .stat-item {
      text-align: center;
      padding: 1.5rem;
      background: var(--gray);
      border: 1px solid var(--gray-mid);
      clip-path: polygon(8px 0, 100% 0, calc(100% - 8px) 100%, 0 100%);
      transition: all 0.3s ease;
    }

    .stat-item:hover {
      border-color: var(--white-30);
      box-shadow: 0 0 30px var(--white-10);
      transform: translateY(-3px);
    }

    .stat-value {
      font-family: 'Bangers', cursive;
      font-size: 2.5rem;
      color: var(--white);
      line-height: 1;
      text-shadow: 0 0 15px var(--white-30), 3px 3px 0 var(--white-10);
    }

    .stat-label {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.6rem;
      color: var(--text-dim);
      letter-spacing: 2px;
      text-transform: uppercase;
      margin-top: 0.75rem;
    }

    /* ===== MODAL ===== */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.9);
      backdrop-filter: blur(10px);
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .modal {
      background: var(--gray);
      border: 1px solid var(--gray-mid);
      max-width: 550px;
      width: 90%;
      max-height: 85vh;
      overflow-y: auto;
      position: relative;
      clip-path: polygon(20px 0, 100% 0, 100% calc(100% - 20px), calc(100% - 20px) 100%, 0 100%, 0 20px);
      transform: scale(0.9) translateY(20px);
      transition: transform 0.3s ease;
    }

    .modal-overlay.active .modal {
      transform: scale(1) translateY(0);
    }

    .modal-header {
      padding: 2rem 2rem 0;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
    }

    .modal-tag {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.6rem;
      letter-spacing: 3px;
      text-transform: uppercase;
      color: var(--accent);
    }

    .modal-close {
      background: none;
      border: none;
      color: var(--text-dim);
      font-size: 1.5rem;
      cursor: pointer;
      transition: color 0.2s;
      line-height: 1;
    }

    .modal-close:hover {
      color: var(--white);
    }

    .modal-body {
      padding: 1.5rem 2rem 2rem;
    }

    .modal-title {
      font-family: 'Russo One', sans-serif;
      font-size: 1.8rem;
      color: var(--white);
      letter-spacing: 3px;
      margin-bottom: 1.5rem;
      text-shadow: 0 0 30px var(--white-20);
    }

    .modal-text {
      font-size: 0.95rem;
      color: var(--text-dim);
      line-height: 1.9;
      margin-bottom: 1.25rem;
    }

    .modal-text strong {
      color: var(--white);
    }

    .modal-text em {
      color: var(--accent);
      font-style: normal;
    }

    .modal-features {
      display: flex;
      justify-content: space-between;
      gap: 1rem;
      margin: 2rem 0;
    }

    .modal-feature {
      text-align: center;
      flex: 1;
    }

    .modal-feature-icon {
      width: 45px;
      height: 45px;
      margin: 0 auto 0.75rem;
      background: var(--void);
      border: 1px solid var(--gray-mid);
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'Russo One', sans-serif;
      font-size: 0.9rem;
      color: var(--white);
      clip-path: polygon(6px 0, 100% 0, calc(100% - 6px) 100%, 0 100%);
    }

    .modal-feature-label {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.55rem;
      letter-spacing: 1px;
      text-transform: uppercase;
      color: var(--text-dim);
    }

    .modal-cta {
      margin-top: 1.5rem;
      padding-top: 1.5rem;
      border-top: 1px solid var(--gray-mid);
    }

    .modal-cta a {
      font-family: 'Russo One', sans-serif;
      font-size: 0.75rem;
      letter-spacing: 2px;
      color: var(--accent);
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      transition: all 0.2s;
    }

    .modal-cta a:hover {
      text-shadow: 0 0 20px var(--accent-50);
    }

    .modal-cta a::after {
      content: '\2192';
    }

    /* ===== FOOTER ===== */
    footer {
      padding: 2rem 4rem;
      background: var(--void);
      border-top: 1px solid var(--gray-mid);
    }

    footer::before {
      content: '';
      display: block;
      height: 3px;
      background: linear-gradient(90deg, var(--white-30), var(--white), var(--white-30));
      margin: -2rem -4rem 2rem;
    }

    .footer-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1200px;
      margin: 0 auto;
    }

    .footer-logo {
      font-family: 'Russo One', sans-serif;
      font-size: 1.4rem;
      color: var(--white);
      text-shadow: 0 0 10px var(--white-50);
      letter-spacing: 3px;
    }

    .footer-links {
      display: flex;
      gap: 2rem;
    }

    .footer-links a {
      color: var(--text-dim);
      text-decoration: none;
      font-size: 0.7rem;
      letter-spacing: 2px;
      text-transform: uppercase;
      transition: all 0.2s;
    }

    .footer-links a:hover {
      color: var(--white);
      text-shadow: 0 0 10px var(--white-50);
    }

    /* ===== RESPONSIVE ===== */

    /* Tablet */
    @media (max-width: 900px) {
      nav { padding: 1rem 1.5rem; }
      .nav-links { display: none; }
      .logo { font-size: 1.4rem; }
      .logo-x { font-size: 1rem; padding: 0.1rem 0.4rem; }
      .nav-cta { padding: 0.7rem 1.2rem; font-size: 0.75rem; }

      .hero { padding: 6rem 1.5rem 2rem; min-height: 100svh; }
      .hero-title { font-size: clamp(3rem, 12vw, 6rem); letter-spacing: 4px; }
      .title-tld { display: block; margin-top: 0.25rem; }

      .hero-desc { font-size: 0.9rem; padding: 0 1rem; margin-bottom: 1.5rem; }
      .hero-badge { margin-bottom: 1.5rem; }

      .battle-section { gap: 1.5rem; margin-bottom: 2rem; }
      .player-slot { width: 85px; height: 110px; }
      .player-avatar { width: 40px; height: 40px; }
      .vs-text { font-size: 2.2rem; }

      .feature-badges { gap: 0.5rem; margin-bottom: 2rem; }
      .feature-badge { font-size: 0.65rem; padding: 0.4rem 0.75rem; }

      .email-form {
        flex-direction: column;
        gap: 0.75rem;
        width: 100%;
        max-width: 320px;
      }
      .email-input {
        width: 100%;
        border: 2px solid var(--gray-mid);
        clip-path: polygon(10px 0, 100% 0, calc(100% - 10px) 100%, 0 100%);
        text-align: center;
        padding: 1rem;
        font-size: 1rem;
      }
      .submit-btn {
        width: 100%;
        padding: 1rem;
        font-size: 0.9rem;
        clip-path: polygon(10px 0, 100% 0, calc(100% - 10px) 100%, 0 100%);
      }

      .ticker { padding: 0.75rem 0; }
      .ticker-item { font-size: 1.1rem; padding: 0 1.5rem; gap: 1.5rem; }
      .ticker-item::after { font-size: 0.8rem; }

      .stats-grid { grid-template-columns: repeat(2, 1fr); gap: 1rem; }
      .stats-bar { padding: 2rem 1.5rem; }
      .stat-item { padding: 1.25rem 1rem; }
      .stat-value { font-size: 1.8rem; }
      .stat-label { font-size: 0.55rem; letter-spacing: 1px; }

      footer { padding: 1.5rem; }
      footer::before { margin: -1.5rem -1.5rem 1.5rem; }
      .footer-content { flex-direction: column; gap: 1rem; text-align: center; }
      .footer-links { gap: 1.5rem; flex-wrap: wrap; justify-content: center; }
      .footer-logo { font-size: 1.2rem; }

      /* Modal mobile */
      .modal {
        width: 95%;
        max-height: 90vh;
        clip-path: polygon(15px 0, 100% 0, 100% calc(100% - 15px), calc(100% - 15px) 100%, 0 100%, 0 15px);
      }
      .modal-header { padding: 1.5rem 1.5rem 0; }
      .modal-body { padding: 1.25rem 1.5rem 1.5rem; }
      .modal-title { font-size: 1.4rem; letter-spacing: 2px; }
      .modal-text { font-size: 0.9rem; line-height: 1.7; }
      .modal-features { gap: 0.75rem; }
      .modal-feature-icon { width: 40px; height: 40px; font-size: 0.8rem; }
      .modal-feature-label { font-size: 0.5rem; }
    }

    /* Mobile */
    @media (max-width: 480px) {
      nav { padding: 0.75rem 1rem; }
      .logo { font-size: 1.2rem; letter-spacing: 2px; }
      .logo-x { font-size: 0.9rem; }
      .nav-cta { padding: 0.6rem 1rem; font-size: 0.7rem; letter-spacing: 1px; }

      .hero { padding: 5rem 1rem 1.5rem; }
      .hero-title { font-size: clamp(2.5rem, 15vw, 4rem); letter-spacing: 2px; margin-bottom: 0.5rem; }
      .title-tld { font-size: 0.7em; }

      .hero-badge { padding: 0.4rem 0.75rem; margin-bottom: 1rem; }
      .hero-badge-icon { width: 8px; height: 8px; }
      .hero-badge-text { font-size: 0.5rem; letter-spacing: 2px; }

      .hero-desc { font-size: 0.85rem; line-height: 1.6; padding: 0 0.5rem; margin-bottom: 1.25rem; }

      .battle-section { gap: 1rem; margin-bottom: 1.5rem; }
      .player-slot { width: 70px; height: 90px; gap: 0.5rem; }
      .player-avatar { width: 32px; height: 32px; }
      .player-avatar svg { width: 16px; height: 16px; }
      .player-name { font-size: 0.45rem; letter-spacing: 1px; }
      .vs-text { font-size: 1.6rem; }
      .vs-sub { font-size: 0.4rem; letter-spacing: 2px; }

      .feature-badges { gap: 0.4rem; margin-bottom: 1.5rem; }
      .feature-badge { font-size: 0.55rem; padding: 0.35rem 0.6rem; letter-spacing: 1px; }

      .cta-container { gap: 1rem; }
      .email-form { max-width: 100%; padding: 0 0.5rem; }
      .email-input {
        padding: 0.9rem;
        font-size: 0.9rem;
        border-radius: 0;
      }
      .submit-btn {
        padding: 0.9rem;
        font-size: 0.8rem;
      }
      .waitlist-count { font-size: 0.6rem; }

      .ticker { padding: 0.6rem 0; }
      .ticker-item { font-size: 0.9rem; padding: 0 1rem; gap: 1rem; letter-spacing: 2px; }
      .ticker-item::after { font-size: 0.7rem; padding: 0.15rem 0.4rem; }

      .stats-bar { padding: 1.5rem 1rem; }
      .stats-grid { gap: 0.75rem; }
      .stat-item { padding: 1rem 0.75rem; }
      .stat-value { font-size: 1.5rem; }
      .stat-label { font-size: 0.45rem; margin-top: 0.5rem; }

      footer { padding: 1.25rem 1rem; }
      footer::before { margin: -1.25rem -1rem 1.25rem; height: 2px; }
      .footer-logo { font-size: 1rem; letter-spacing: 2px; }
      .footer-links { gap: 1rem; }
      .footer-links a { font-size: 0.6rem; }

      /* Modal mobile small */
      .modal-header { padding: 1.25rem 1.25rem 0; }
      .modal-close { font-size: 1.25rem; }
      .modal-body { padding: 1rem 1.25rem 1.25rem; }
      .modal-title { font-size: 1.2rem; margin-bottom: 1rem; }
      .modal-text { font-size: 0.85rem; margin-bottom: 1rem; }
      .modal-features { margin: 1.5rem 0; }
      .modal-feature-icon { width: 35px; height: 35px; font-size: 0.7rem; }
      .modal-cta { margin-top: 1rem; padding-top: 1rem; }
      .modal-cta a { font-size: 0.7rem; }
    }

    /* Extra small phones */
    @media (max-width: 360px) {
      .hero-title { font-size: 2.2rem; }
      .title-tld { font-size: 0.65em; }
      .player-slot { width: 60px; height: 80px; }
      .player-avatar { width: 28px; height: 28px; }
      .vs-text { font-size: 1.4rem; }
      .feature-badge { font-size: 0.5rem; padding: 0.3rem 0.5rem; }
    }

    /* Touch-friendly improvements */
    @media (hover: none) and (pointer: coarse) {
      .player-slot:hover { transform: none; }
      .stat-item:hover { transform: none; }
      .nav-cta:hover { transform: none; }
      .submit-btn:hover { transform: none; }

      .submit-btn:active {
        transform: scale(0.98);
        box-shadow: 0 0 20px var(--accent-30);
      }

      .player-slot:active {
        border-color: var(--white-50);
        box-shadow: 0 0 20px var(--white-10);
      }
    }

    /* Safe area for notched phones */
    @supports (padding: env(safe-area-inset-bottom)) {
      footer {
        padding-bottom: calc(1.5rem + env(safe-area-inset-bottom));
      }
      nav {
        padding-top: calc(1rem + env(safe-area-inset-top));
      }
    }

    /* ===== SPIN WHEEL MODAL ===== */
    .spin-modal {
      max-width: 380px;
      background: var(--void);
    }

    .spin-modal-body {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      padding: 1rem 1.5rem 1.5rem;
    }

    .spin-title {
      font-family: 'Bangers', cursive;
      font-size: 2rem;
      color: var(--white);
      letter-spacing: 2px;
      margin-bottom: 0.25rem;
    }

    .spin-title .amount {
      color: var(--accent);
      text-shadow: 0 0 20px var(--accent-50);
    }

    .spin-subtitle {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.6rem;
      color: var(--text-dim);
      letter-spacing: 1px;
      margin-bottom: 1.5rem;
    }

    /* Wheel container */
    .wheel-container {
      position: relative;
      width: 240px;
      height: 240px;
      margin-bottom: 1.5rem;
    }

    /* Pointer arrow */
    .wheel-pointer {
      position: absolute;
      top: -5px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 20;
      font-size: 1.2rem;
      color: var(--accent);
      filter: drop-shadow(0 0 6px var(--accent));
    }

    #wheelCanvas {
      border-radius: 50%;
      box-shadow: 0 0 20px rgba(0,0,0,0.5);
    }

    .wheel-center-dot {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 40px;
      height: 40px;
      background: var(--void);
      border-radius: 50%;
      border: 3px solid var(--accent);
      z-index: 10;
      box-shadow: 0 0 15px var(--accent-30);
    }

    /* Spin form */
    .spin-form {
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    .wallet-input {
      width: 100%;
      padding: 0.85rem 1rem;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.65rem;
      background: var(--gray);
      border: 1px solid var(--gray-mid);
      border-radius: 6px;
      color: var(--text);
      outline: none;
      transition: all 0.2s;
      text-align: center;
    }

    .wallet-input::placeholder { color: var(--text-dim); }
    .wallet-input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 2px var(--accent-20);
    }

    .spin-btn {
      padding: 0.85rem 1.5rem;
      font-family: 'Russo One', sans-serif;
      font-size: 0.9rem;
      letter-spacing: 2px;
      background: var(--accent);
      border: none;
      border-radius: 6px;
      color: var(--black);
      cursor: pointer;
      transition: all 0.2s;
    }

    .spin-btn:hover:not(:disabled) {
      background: #d4ff33;
      transform: translateY(-1px);
    }

    .spin-btn:disabled {
      background: var(--gray-mid);
      color: var(--text-dim);
      cursor: not-allowed;
    }

    .spin-note {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.55rem;
      color: var(--text-dim);
      margin-top: 0.25rem;
    }

    /* Prize result popup */
    .prize-popup {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.9);
      z-index: 10002;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s;
    }

    .prize-popup.active {
      opacity: 1;
      visibility: visible;
    }

    .prize-content {
      text-align: center;
      padding: 2rem;
    }

    .prize-label {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.65rem;
      letter-spacing: 2px;
      color: var(--text-dim);
      margin-bottom: 0.75rem;
    }

    .prize-value {
      font-family: 'Bangers', cursive;
      font-size: 3rem;
      color: var(--white);
      letter-spacing: 3px;
      margin-bottom: 0.75rem;
    }

    .prize-message {
      font-size: 0.85rem;
      color: var(--text-dim);
      margin-bottom: 1.5rem;
      max-width: 260px;
    }

    .prize-close {
      font-family: 'Russo One', sans-serif;
      font-size: 0.7rem;
      letter-spacing: 1px;
      background: var(--accent);
      color: var(--black);
      border: none;
      border-radius: 4px;
      padding: 0.6rem 1.5rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .prize-close:hover {
      background: #d4ff33;
    }

    /* Nav spin button */
    .nav-spin {
      font-family: 'Russo One', sans-serif;
      font-size: 0.7rem;
      letter-spacing: 1px;
      background: var(--accent);
      color: var(--black);
      padding: 0.5rem 0.9rem;
      border-radius: 4px;
      cursor: pointer;
      border: none;
      transition: all 0.2s;
    }

    .nav-spin:hover {
      background: #d4ff33;
    }

    /* Mobile */
    @media (max-width: 480px) {
      .spin-modal { width: 92%; }
      .spin-modal-body { padding: 0.75rem 1rem 1.25rem; }
      .spin-title { font-size: 1.6rem; }
      .wheel-container { width: 200px; height: 200px; }
      .wheel-center { width: 40px; height: 40px; }
      .segment-10k-label { font-size: 0.6rem; }
      .nav-spin { font-size: 0.6rem; padding: 0.4rem 0.7rem; }
    }
  </style>
</head>
<body>
  <!-- Navigation -->
  <nav>
    <a href="#" class="logo">
      <span class="logo-x">x</span>BAGWORK
    </a>
    <ul class="nav-links">
      <li><a href="https://discord.gg/Tr3MzXNN" target="_blank">Discord</a></li>
      <li><a href="https://x.com/onlybagwork" target="_blank">Twitter</a></li>
      <li><a href="#" onclick="openModal(); return false;">About</a></li>
    </ul>
    <div style="display: flex; gap: 1rem; align-items: center;">
      <button class="nav-spin" onclick="openSpinModal()">$10K SPIN</button>
      <a href="#" class="nav-cta">JOIN WAITLIST</a>
    </div>
  </nav>

  <!-- Hero -->
  <section class="hero">
    <div class="hero-bg"></div>
    <div class="hero-grid"></div>

    <div class="hero-content">
      <div class="hero-badge">
        <span class="hero-badge-icon"></span>
        <span class="hero-badge-text">Coming Q2 2025</span>
      </div>

      <h1 class="hero-title">BAGWORK<span class="title-tld">.BET</span></h1>

      <p class="hero-desc">
        Skill-based wagering. <strong>No house edge</strong>.
        Challenge anyone. Win everything. The future of competitive gaming.
      </p>

      <div class="battle-section">
        <div class="player-slot p1">
          <div class="player-avatar">
            <svg viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
          </div>
          <span class="player-name">Player 1</span>
        </div>

        <div class="vs-center">
          <div class="vs-text">VS</div>
          <span class="vs-sub">Real-time PvP</span>
        </div>

        <div class="player-slot p2">
          <div class="player-avatar">
            <svg viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
          </div>
          <span class="player-name">Player 2</span>
        </div>
      </div>

      <div class="feature-badges">
        <span class="feature-badge">xSKILL</span>
        <span class="feature-badge outline">xWAGER</span>
        <span class="feature-badge outline">xINSTANT</span>
      </div>

      <div class="cta-container">
        <form class="email-form" onsubmit="handleSubmit(event)">
          <input type="email" class="email-input" placeholder="Enter your email" required>
          <button type="submit" class="submit-btn">GET ACCESS</button>
        </form>
        <p class="waitlist-count">Join <span id="waitlistCount">2,847</span> others on the waitlist</p>
      </div>
    </div>
  </section>

  <!-- Ticker -->
  <div class="ticker">
    <div class="ticker-track">
      <span class="ticker-item">PVP WAGERING</span>
      <span class="ticker-item">PURE SKILL</span>
      <span class="ticker-item">FAST PAYOUTS</span>
      <span class="ticker-item">TEAM BATTLES</span>
      <span class="ticker-item">PLAY TO WIN</span>
      <span class="ticker-item">COMING SOON</span>
      <span class="ticker-item">PVP WAGERING</span>
      <span class="ticker-item">PURE SKILL</span>
      <span class="ticker-item">FAST PAYOUTS</span>
      <span class="ticker-item">TEAM BATTLES</span>
      <span class="ticker-item">PLAY TO WIN</span>
      <span class="ticker-item">COMING SOON</span>
    </div>
  </div>

  <!-- Spin Wheel Modal -->
  <div class="modal-overlay" id="spinModal">
    <div class="modal spin-modal">
      <div class="modal-header">
        <span class="modal-tag">Daily Spin</span>
        <button class="modal-close" onclick="closeSpinModal()">&times;</button>
      </div>
      <div class="modal-body spin-modal-body">
        <h2 class="spin-title">WIN <span class="amount">$10,000</span></h2>
        <p class="spin-subtitle">One free spin per day</p>

        <div class="wheel-container">
          <div class="wheel-pointer">▼</div>
          <canvas id="wheelCanvas" width="240" height="240"></canvas>
          <div class="wheel-center-dot"></div>
        </div>

        <form class="spin-form" onsubmit="handleSpin(event)">
          <input type="text" class="wallet-input" id="walletInput" placeholder="Enter wallet address to spin" required minlength="32" maxlength="64">
          <button type="submit" class="spin-btn" id="spinBtn">SPIN TO WIN</button>
        </form>
        <p class="spin-note" id="spinNote">Enter wallet • Spin daily • Win big</p>
      </div>
    </div>
  </div>

  <!-- Prize Popup -->
  <div class="prize-popup" id="prizePopup">
    <div class="prize-content">
      <p class="prize-label" id="prizeLabel">Better Luck Tomorrow!</p>
      <h2 class="prize-value" id="prizeValue">NO WIN</h2>
      <p class="prize-message" id="prizeMessage">Come back tomorrow for another chance at $10,000!</p>
      <button class="prize-close" onclick="closePrizePopup()">CLOSE</button>
    </div>
  </div>

  <!-- Stats -->
  <section class="stats-bar">
    <div class="stats-grid">
      <div class="stat-item">
        <div class="stat-value">PVP</div>
        <div class="stat-label">Player vs Player</div>
      </div>
      <div class="stat-item">
        <div class="stat-value">TEAM</div>
        <div class="stat-label">Squad Battles</div>
      </div>
      <div class="stat-item">
        <div class="stat-value">SKILL</div>
        <div class="stat-label">No Luck</div>
      </div>
      <div class="stat-item">
        <div class="stat-value">&#9889;</div>
        <div class="stat-label">Fast Payouts</div>
      </div>
    </div>
  </section>

  <!-- About Modal -->
  <div class="modal-overlay" id="aboutModal">
    <div class="modal">
      <div class="modal-header">
        <span class="modal-tag">About</span>
        <button class="modal-close" onclick="closeModal()">&times;</button>
      </div>
      <div class="modal-body">
        <h2 class="modal-title">WHAT IS BAGWORK?</h2>

        <p class="modal-text">
          <strong>BAGWORK</strong> is a skill-based PVP wagering platform.
          Challenge players head-to-head or team up for squad battles.
          <em>No luck. Pure skill.</em> The better player wins.
        </p>

        <p class="modal-text">
          We're building something different. A place where gamers can
          put their skills on the line and compete for real stakes.
        </p>

        <div class="modal-features">
          <div class="modal-feature">
            <div class="modal-feature-icon">1v1</div>
            <div class="modal-feature-label">Head to Head</div>
          </div>
          <div class="modal-feature">
            <div class="modal-feature-icon">NvN</div>
            <div class="modal-feature-label">Team Battles</div>
          </div>
          <div class="modal-feature">
            <div class="modal-feature-icon">$$$</div>
            <div class="modal-feature-label">Real Stakes</div>
          </div>
        </div>

        <div class="modal-cta">
          <a href="https://x.com/onlybagwork" target="_blank">Follow for updates</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <div class="footer-content">
      <span class="footer-logo">BAGWORK</span>
      <div class="footer-links">
        <a href="https://discord.gg/Tr3MzXNN" target="_blank">Discord</a>
        <a href="https://x.com/onlybagwork" target="_blank">Twitter</a>
        <a href="#">Terms</a>
      </div>
    </div>
  </footer>

  <script>
    // Modal functions
    function openModal() {
      document.getElementById('aboutModal').classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closeModal() {
      document.getElementById('aboutModal').classList.remove('active');
      document.body.style.overflow = '';
    }

    // Close modal on overlay click
    document.getElementById('aboutModal').addEventListener('click', (e) => {
      if (e.target === e.currentTarget) closeModal();
    });

    // Close modal on Escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') closeModal();
    });

    // Store the current waitlist count
    let waitlistTotal = 2847;

    // Form handler
    async function handleSubmit(e) {
      e.preventDefault();
      const btn = e.target.querySelector('.submit-btn');
      const input = e.target.querySelector('.email-input');
      const count = document.getElementById('waitlistCount');

      btn.disabled = true;
      btn.textContent = 'SENDING...';

      try {
        const res = await fetch('/api/subscribe', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email: input.value })
        });

        const data = await res.json();

        if (res.ok && data.success) {
          btn.textContent = "YOU'RE IN!";
          btn.style.background = 'var(--accent)';
          waitlistTotal++;
          count.textContent = waitlistTotal.toLocaleString();
          input.value = '';
        } else {
          btn.textContent = 'TRY AGAIN';
          console.error('Subscribe error:', data);
        }
      } catch (err) {
        btn.textContent = 'TRY AGAIN';
        console.error('Network error:', err);
      }

      setTimeout(() => {
        btn.disabled = false;
        btn.textContent = 'GET ACCESS';
        btn.style.background = '';
      }, 3000);
    }

    // Animated waitlist counter
    function animateValue(id, start, end, duration) {
      const obj = document.getElementById(id);
      let startTimestamp = null;
      const step = (timestamp) => {
        if (!startTimestamp) startTimestamp = timestamp;
        const prog = Math.min((timestamp - startTimestamp) / duration, 1);
        obj.textContent = Math.floor(prog * (end - start) + start).toLocaleString();
        if (prog < 1) window.requestAnimationFrame(step);
      };
      window.requestAnimationFrame(step);
    }

    // Fetch live waitlist count from API
    async function fetchWaitlistCount() {
      try {
        const res = await fetch('/api/count');
        const data = await res.json();
        if (data.success && data.count) {
          waitlistTotal = data.count;
          animateValue('waitlistCount', 0, waitlistTotal, 1500);
        } else {
          animateValue('waitlistCount', 0, 2847, 1500);
        }
      } catch (err) {
        // Fallback to base count on error
        animateValue('waitlistCount', 0, 2847, 1500);
      }
    }

    // Start fetching count on load
    setTimeout(fetchWaitlistCount, 500);

    // ===== SPIN WHEEL =====
    const SPIN_STORAGE_KEY = 'bagwork_spin_state';
    const BASE58_CHARS = '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz';

    // Wheel state
    let wheelAngle = 0;
    let isSpinning = false;
    let wheelCanvas, wheelCtx;

    // Initialize wheel on page load
    document.addEventListener('DOMContentLoaded', () => {
      wheelCanvas = document.getElementById('wheelCanvas');
      if (wheelCanvas) {
        wheelCtx = wheelCanvas.getContext('2d');
        drawWheel(0);
      }
    });

    // Draw the wheel
    function drawWheel(rotation) {
      if (!wheelCtx) return;
      const ctx = wheelCtx;
      const w = wheelCanvas.width;
      const h = wheelCanvas.height;
      const cx = w / 2;
      const cy = h / 2;
      const r = Math.min(cx, cy) - 5;

      ctx.clearRect(0, 0, w, h);
      ctx.save();
      ctx.translate(cx, cy);
      ctx.rotate(rotation * Math.PI / 180);

      // Draw 12 segments
      const segments = 12;
      const segAngle = (2 * Math.PI) / segments;

      for (let i = 0; i < segments; i++) {
        ctx.beginPath();
        ctx.moveTo(0, 0);
        ctx.arc(0, 0, r, i * segAngle, (i + 1) * segAngle);
        ctx.closePath();

        // One segment is the $10K (lime), rest are dark
        if (i === 0) {
          ctx.fillStyle = '#BFFF00';
        } else {
          ctx.fillStyle = i % 2 === 0 ? '#1a1a1a' : '#111111';
        }
        ctx.fill();
        ctx.strokeStyle = '#333';
        ctx.lineWidth = 1;
        ctx.stroke();
      }

      // Draw $10K label on the winning segment
      ctx.rotate(segAngle / 2);
      ctx.fillStyle = '#000';
      ctx.font = 'bold 14px Russo One, sans-serif';
      ctx.textAlign = 'center';
      ctx.fillText('$10K', r * 0.65, 5);

      ctx.restore();

      // Outer ring
      ctx.beginPath();
      ctx.arc(cx, cy, r, 0, 2 * Math.PI);
      ctx.strokeStyle = '#444';
      ctx.lineWidth = 4;
      ctx.stroke();
    }

    // Animate spin
    function animateSpin(targetAngle, duration, callback) {
      const startAngle = wheelAngle;
      const startTime = performance.now();

      function animate(currentTime) {
        const elapsed = currentTime - startTime;
        const progress = Math.min(elapsed / duration, 1);

        // Easing function (ease out cubic)
        const eased = 1 - Math.pow(1 - progress, 3);

        wheelAngle = startAngle + (targetAngle - startAngle) * eased;
        drawWheel(wheelAngle);

        if (progress < 1) {
          requestAnimationFrame(animate);
        } else {
          wheelAngle = targetAngle;
          if (callback) callback();
        }
      }

      requestAnimationFrame(animate);
    }

    function isValidSolanaWallet(address) {
      if (!address || address.length < 32 || address.length > 44) return false;
      for (const char of address) {
        if (!BASE58_CHARS.includes(char)) return false;
      }
      return true;
    }

    function getToday() {
      return new Date().toISOString().split('T')[0];
    }

    function getSpinState() {
      try {
        const state = JSON.parse(localStorage.getItem(SPIN_STORAGE_KEY) || '{}');
        if (state.date !== getToday()) {
          return { date: getToday(), spun: false, hasRetry: false, retryUsed: false };
        }
        return state;
      } catch {
        return { date: getToday(), spun: false, hasRetry: false, retryUsed: false };
      }
    }

    function setSpinState(updates) {
      const state = getSpinState();
      Object.assign(state, updates, { date: getToday() });
      localStorage.setItem(SPIN_STORAGE_KEY, JSON.stringify(state));
    }

    function canSpin() {
      const state = getSpinState();
      return !state.spun || (state.hasRetry && !state.retryUsed);
    }

    function isUsingRetry() {
      const state = getSpinState();
      return state.spun && state.hasRetry && !state.retryUsed;
    }

    function openSpinModal() {
      document.getElementById('spinModal').classList.add('active');
      document.body.style.overflow = 'hidden';
      // Reinit canvas when modal opens
      wheelCanvas = document.getElementById('wheelCanvas');
      if (wheelCanvas) {
        wheelCtx = wheelCanvas.getContext('2d');
        drawWheel(wheelAngle);
      }
      updateSpinUI();
    }

    function closeSpinModal() {
      document.getElementById('spinModal').classList.remove('active');
      document.body.style.overflow = '';
    }

    function updateSpinUI() {
      const btn = document.getElementById('spinBtn');
      const note = document.getElementById('spinNote');

      if (!canSpin()) {
        btn.disabled = true;
        btn.textContent = 'COME BACK TOMORROW';
        note.textContent = 'You already spun today!';
        note.style.color = 'var(--accent)';
      } else if (isUsingRetry()) {
        btn.disabled = false;
        btn.textContent = 'SPIN AGAIN!';
        note.textContent = 'Use your free retry!';
        note.style.color = 'var(--accent)';
      } else {
        btn.disabled = false;
        btn.textContent = 'SPIN TO WIN';
        note.textContent = 'Enter wallet • Spin daily • Win big';
        note.style.color = '';
      }
    }

    // Close modal on overlay click
    document.getElementById('spinModal').addEventListener('click', (e) => {
      if (e.target === e.currentTarget) closeSpinModal();
    });

    async function handleSpin(e) {
      e.preventDefault();
      if (isSpinning || !canSpin()) return;

      const wallet = document.getElementById('walletInput').value.trim();
      const btn = document.getElementById('spinBtn');
      const note = document.getElementById('spinNote');

      if (!isValidSolanaWallet(wallet)) {
        note.textContent = 'Enter a valid Solana wallet address';
        note.style.color = '#e00';
        setTimeout(() => updateSpinUI(), 2000);
        return;
      }

      const usingRetry = isUsingRetry();
      isSpinning = true;
      btn.disabled = true;
      btn.textContent = 'SPINNING...';
      note.textContent = 'Good luck!';
      note.style.color = 'var(--accent)';

      try {
        const res = await fetch('/api/spin', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ wallet, isRetry: usingRetry })
        });

        const data = await res.json();

        if (res.status === 429) {
          setSpinState({ spun: true, hasRetry: false, retryUsed: true });
          btn.textContent = 'COME BACK TOMORROW';
          note.textContent = data.message || 'One spin per day!';
          isSpinning = false;
          return;
        }

        if (!res.ok || !data.success) {
          throw new Error(data.error || 'Spin failed');
        }

        // Update state
        if (usingRetry) {
          setSpinState({ spun: true, hasRetry: true, retryUsed: true });
        } else {
          setSpinState({ spun: true, hasRetry: data.canRetry, retryUsed: false });
        }

        // Spin animation - always land away from $10K (segment 0)
        // Land on segments 3-10 (safe zone)
        const spins = 5 + Math.floor(Math.random() * 3);
        const safeSegment = 3 + Math.floor(Math.random() * 8);
        const segmentAngle = 360 / 12;
        const targetAngle = wheelAngle + (spins * 360) + (safeSegment * segmentAngle) + (segmentAngle / 2);

        animateSpin(targetAngle, 4000, () => {
          if (data.canRetry) {
            showTryAgain();
          } else {
            showNoWin();
          }
          updateSpinUI();
          isSpinning = false;
        });

      } catch (err) {
        console.error('Spin error:', err);
        note.textContent = err.message || 'Something went wrong';
        note.style.color = '#e00';
        isSpinning = false;
        setTimeout(() => updateSpinUI(), 2000);
      }
    }

    function showNoWin() {
      document.getElementById('prizeLabel').textContent = 'Better Luck Tomorrow!';
      document.getElementById('prizeValue').textContent = 'SO CLOSE!';
      document.getElementById('prizeMessage').textContent = 'Come back tomorrow for another chance at $10,000!';
      document.getElementById('prizePopup').classList.add('active');
    }

    function showTryAgain() {
      document.getElementById('prizeLabel').textContent = 'Lucky!';
      document.getElementById('prizeValue').textContent = 'FREE SPIN!';
      document.getElementById('prizeMessage').textContent = 'You get another spin! Go for the $10,000!';
      document.getElementById('prizePopup').classList.add('active');
    }

    function closePrizePopup() {
      document.getElementById('prizePopup').classList.remove('active');
    }

    // Close modals on escape
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        closePrizePopup();
        closeSpinModal();
        closeModal();
      }
    });
  </script>
</body>
</html>
